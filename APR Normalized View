let
    Source = #"APR Call",

    // Pick the columns you actually use (add/remove as needed)
    KeepCols = Table.SelectColumns(
        Source,
        {
            "Id",
            "DateofCall",            // APR has this exact casing
            "CommitmentDate",
            "DateOfFollowUp",
            "Area","District","Unit",
            "WhoSpoke",
            "Commitments",
            "APRIndicator","Indicator","ServiceIndicator","ServiceIndicato", // keep all so we can coalesce
            "ActionTaken",
            "DaysRemaining",
            "MPOOView","DistrictView","OfficeLevel",
            "Status_Switch",
            "Created","Modified"
        },
        MissingField.Ignore
    ),

    // Coalesce indicator fields into a single unified field
    AddIndicatorUnified = Table.AddColumn(
        KeepCols, "IndicatorUnified",
        each if Text.FromNullable([Indicator]) <> "" then [Indicator]
             else if Text.FromNullable([APRIndicator]) <> "" then [APRIndicator]
             else null
    ),

    // Coalesce service indicator (handles typos/truncation)
    AddServiceUnified = Table.AddColumn(
        AddIndicatorUnified, "ServiceIndicatorUnified",
        each if Record.HasFields(_, "ServiceIndicator") and Text.FromNullable([ServiceIndicator]) <> "" then [ServiceIndicator]
             else if Record.HasFields(_, "ServiceIndicato") and Text.FromNullable([ServiceIndicato]) <> "" then [ServiceIndicato]
             else null
    ),

    // Standardize column names/types
    Renamed = Table.TransformColumnTypes(
        Table.RenameColumns(
            AddServiceUnified,
            {
                {"DateofCall","DateOfCall"}
            },
            MissingField.Ignore
        ),
        {
            {"Id", Int64.Type},
            {"DateOfCall", type datetime},
            {"CommitmentDate", type datetime},
            {"DateOfFollowUp", type datetime},
            {"Area", type text},
            {"District", type text},
            {"Unit", type text},
            {"WhoSpoke", type text},
            {"Commitments", type text},
            {"IndicatorUnified", type text},
            {"ServiceIndicatorUnified", type text},
            {"ActionTaken", type text},
            {"DaysRemaining", Int64.Type},
            {"MPOOView", type text},
            {"DistrictView", type text},
            {"OfficeLevel", type text},
            {"Status_Switch", type text},
            {"Created", type datetime},
            {"Modified", type datetime}
        },
        "en-US"
    ),

    WithListType = Table.AddColumn(Renamed, "ListType", each "APR", type text),

    APR_Normalized = Table.SelectColumns(
        WithListType,
        {
            "ListType","Id","DateOfCall","CommitmentDate","DateOfFollowUp",
            "Area","District","Unit",
            "WhoSpoke","Commitments",
            "IndicatorUnified","ServiceIndicatorUnified",
            "ActionTaken","DaysRemaining",
            "MPOOView","DistrictView","OfficeLevel",
            "Status_Switch","Created","Modified"
        },
        MissingField.Ignore
    )
in
    APR_Normalized
