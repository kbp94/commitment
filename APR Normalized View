let
  Source = APR,

  Keep = Table.SelectColumns(Source,{
    "Id","DateofCall","DateofFollowUp","Area","District","Office","Unit",
    "WhoSpoke?","PersonSpeakingforSite","Commitments",
    "APRIndicator","ServiceIndicator","ServiceIndicato",
    "DueDate","StatusNew","NEW_LastEscalated","NEW_EscalationTier",
    "ActionTaken","MPOO","Created","Modified"
  }, MissingField.Ignore),

  Ren = Table.RenameColumns(Keep,{
    {"DateofCall","DateOfCall"},{"DateofFollowUp","DateOfFollowUp"},
    {"DueDate","CommitmentDate"},{"StatusNew","Status_Switch"},
    {"NEW_LastEscalated","LastEscalated"},{"NEW_EscalationTier","Tier"},
    {"MPOO","MPOOView"}
  }, MissingField.Ignore),

  // Avoid collisions by writing to *_std then renaming later
  UnitStd = Table.AddColumn(Ren,"Unit_std",
              each if Record.HasFields(_, "Unit") and [Unit] <> null then [Unit] else [Office]),

  WhoStd = Table.AddColumn(UnitStd,"WhoSpoke",
              each let w = try Record.Field(_, "WhoSpoke?") otherwise null,
                       p = try [PersonSpeakingforSite] otherwise null
                   in if w <> null and Text.From(w) <> "" then w else p),

  SvcStd = Table.AddColumn(WhoStd,"ServiceIndicator_std",
              each let s1 = try [ServiceIndicator] otherwise null,
                       s2 = try [ServiceIndicato] otherwise null
                   in if s1 <> null and Text.From(s1) <> "" then s1
                      else if s2 <> null and Text.From(s2) <> "" then s2 else null),

  IndUnified = Table.AddColumn(SvcStd,"IndicatorUnified",
                 each let ai = try [APRIndicator] otherwise null
                      in if ai <> null and Text.From(ai) <> "" then ai else null),

  Select = Table.SelectColumns(IndUnified,{
    "Id","DateOfCall","CommitmentDate","DateOfFollowUp",
    "Area","District","Unit_std","WhoSpoke","Commitments",
    "IndicatorUnified","ServiceIndicator_std",
    "Tier","LastEscalated","Status_Switch","ActionTaken","MPOOView",
    "Created","Modified"
  }, MissingField.Ignore),

  RenameFinal = Table.RenameColumns(Select,{
    {"Unit_std","Unit"},
    {"ServiceIndicator_std","ServiceIndicator"}
  }, MissingField.Ignore),

  Types = Table.TransformColumnTypes(RenameFinal,{
    {"Id",Int64.Type},{"DateOfCall",type datetime},{"CommitmentDate",type datetime},{"DateOfFollowUp",type datetime},
    {"Area",type text},{"District",type text},{"Unit",type text},{"WhoSpoke",type text},{"Commitments",type text},
    {"IndicatorUnified",type text},{"ServiceIndicator",type text},{"Tier",type text},{"LastEscalated",type text},
    {"Status_Switch",type text},{"ActionTaken",type text},{"MPOOView",type text},{"Created",type datetime},{"Modified",type datetime}
  }),

  WithType = Table.AddColumn(Types,"ListType", each "APR", type text)
in
  WithType
